import React, { useRef, useState } from "react";
import { ChevronLeft, ChevronRight } from "lucide-react";

interface CardSliderProps {
  items: { id: number; title: string; description: string }[];
}

const CardSlider: React.FC<CardSliderProps> = ({ items }) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const [canScrollLeft, setCanScrollLeft] = useState(false);
  const [canScrollRight, setCanScrollRight] = useState(true);

  const checkScroll = () => {
    if (!containerRef.current) return;
    const { scrollLeft, scrollWidth, clientWidth } = containerRef.current;
    setCanScrollLeft(scrollLeft > 0);
    setCanScrollRight(scrollLeft + clientWidth < scrollWidth - 1);
  };

  const scroll = (direction: "left" | "right") => {
    if (!containerRef.current) return;
    const { clientWidth } = containerRef.current;
    const scrollAmount = direction === "left" ? -clientWidth : clientWidth;
    containerRef.current.scrollBy({ left: scrollAmount, behavior: "smooth" });
    setTimeout(checkScroll, 400); // delay to allow smooth scroll finish
  };

  return (
    <div className="emf-relative emf-w-full emf-max-w-4xl emf-mx-auto">
      {/* Left Button */}
      <button
        onClick={() => scroll("left")}
        disabled={!canScrollLeft}
        className={`emf-absolute emf-left-0 emf-top-1/2 -emf-translate-y-1/2 emf-z-10 emf-bg-white emf-p-2 emf-rounded-full emf-shadow ${
          canScrollLeft ? "emf-opacity-100" : "emf-opacity-50 emf-cursor-not-allowed"
        }`}
      >
        <ChevronLeft />
      </button>

      {/* Scrollable Container */}
      <div
        ref={containerRef}
        onScroll={checkScroll}
        className="emf-flex emf-overflow-x-auto emf-space-x-4 emf-scroll-smooth scrollbar-hide emf-px-10"
      >
        {items.map((item) => (
          <div
            key={item.id}
            className="emf-min-w-[250px] emf-flex-shrink-0 emf-bg-white emf-shadow emf-rounded-2xl emf-p-4"
          >
            <h3 className="emf-font-bold emf-text-lg">{item.title}</h3>
            <p className="emf-text-gray-600">{item.description}</p>
          </div>
        ))}
      </div>

      {/* Right Button */}
      <button
        onClick={() => scroll("right")}
        disabled={!canScrollRight}
        className={`emf-absolute emf-right-0 emf-top-1/2 -emf-translate-y-1/2 emf-z-10 emf-bg-white emf-p-2 emf-rounded-full emf-shadow ${
          canScrollRight ? "emf-opacity-100" : "emf-opacity-50 emf-cursor-not-allowed"
        }`}
      >
        <ChevronRight />
      </button>
    </div>
  );
};

export default CardSlider;
